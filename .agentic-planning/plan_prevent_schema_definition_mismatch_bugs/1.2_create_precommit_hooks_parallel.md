# –≠—Ç–∞–ø 1.2: –°–æ–∑–¥–∞–Ω–∏–µ Pre-commit —Ö—É–∫–æ–≤ (Parallel)

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –°—Ä–µ–¥–Ω–∏–π
**–¢–∏–ø –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** Parallel (–º–æ–∂–Ω–æ –≤—ã–ø–æ–ª–Ω—è—Ç—å –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ —Å —ç—Ç–∞–ø–∞–º–∏ 1.1, 1.3, 1.4)
**–í—Ä–µ–º—è:** 1-2 —á–∞—Å–∞
**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** –¢—Ä–µ–±—É–µ—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —ç—Ç–∞–ø–∞ 0.1

---

## üéØ –¶–µ–ª—å

–°–æ–∑–¥–∞—Ç—å pre-commit —Ö—É–∫, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ schema-definition –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –ü–ï–†–ï–î –∫–æ–º–º–∏—Ç–æ–º. –≠—Ç–æ –ø–æ–∑–≤–æ–ª–∏—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞–º –æ–±–Ω–∞—Ä—É–∂–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—É –Ω–∞ —Å–∞–º–æ–º —Ä–∞–Ω–Ω–µ–º —ç—Ç–∞–ø–µ.

---

## ‚úÖ –ß–µ–∫-–ª–∏—Å—Ç –∑–∞–¥–∞—á

### 1. –ò–∑—É—á–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Ö—É–∫–æ–≤

- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ª–∏ Husky –≤ –ø—Ä–æ–µ–∫—Ç–µ
- [ ] –ò–∑—É—á–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ö—É–∫–∏ –≤ `.husky/`
- [ ] –ò–∑—É—á–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é lint-staged –≤ `package.json` –∏–ª–∏ `.lintstagedrc`
- [ ] –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å, –∫–∞–∫ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤—ã–π —Ö—É–∫ –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É

### 2. –°–æ–∑–¥–∞–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –¥–ª—è pre-commit

- [ ] –°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª `scripts/validate-tool-schema-definition.ts`
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤:
  - –ü–æ–ª—É—á–∞—Ç—å —Å–ø–∏—Å–æ–∫ staged —Ñ–∞–π–ª–æ–≤ —á–µ—Ä–µ–∑ `git diff --cached --name-only`
  - –§–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ —Ñ–∞–π–ª—ã `*.schema.ts` –∏ `*.definition.ts`
  - –û–ø—Ä–µ–¥–µ–ª—è—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –ø–∞—Ä—ã schema-tool –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –¥–ª—è –∫–∞–∂–¥–æ–π –∏–∑–º–µ–Ω–µ–Ω–Ω–æ–π –ø–∞—Ä—ã:
  - –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å schema –∏ tool
  - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç—É –∂–µ –ª–æ–≥–∏–∫—É –≤–∞–ª–∏–¥–∞—Ü–∏–∏, —á—Ç–æ –∏ –≤ —Ç–µ—Å—Ç–∞—Ö (DRY)
  - –°–æ–±–∏—Ä–∞—Ç—å —Å–ø–∏—Å–æ–∫ –æ—à–∏–±–æ–∫
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –≤—ã–≤–æ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤:
  - –ö—Ä–∞—Å–Ω—ã–π —Ç–µ–∫—Å—Ç –¥–ª—è –æ—à–∏–±–æ–∫
  - –ó–µ–ª–µ–Ω—ã–π —Ç–µ–∫—Å—Ç –¥–ª—è —É—Å–ø–µ—à–Ω—ã—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫
  - –°–ø–∏—Å–æ–∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–π
  - –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é

### 3. –°–æ–∑–¥–∞–Ω–∏–µ CLI-–æ–±–µ—Ä—Ç–∫–∏ –¥–ª—è —Å–∫—Ä–∏–ø—Ç–∞

- [ ] –î–æ–±–∞–≤–∏—Ç—å npm —Å–∫—Ä–∏–ø—Ç –≤ `package.json`:
  ```json
  "scripts": {
    "precommit:validate-tools": "tsx scripts/validate-tool-schema-definition.ts"
  }
  ```
- [ ] –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ —Å–∫—Ä–∏–ø—Ç –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç exit code:
  - `0` ‚Äî –≤–∞–ª–∏–¥–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞
  - `1` ‚Äî –Ω–∞–π–¥–µ–Ω—ã –æ—à–∏–±–∫–∏ (–±–ª–æ–∫–∏—Ä—É–µ—Ç –∫–æ–º–º–∏—Ç)

### 4. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Husky (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)

- [ ] –î–æ–±–∞–≤–∏—Ç—å –∏–ª–∏ –æ–±–Ω–æ–≤–∏—Ç—å `.husky/pre-commit`:
  ```bash
  #!/bin/sh
  . "$(dirname "$0")/_/husky.sh"

  # Existing hooks...

  # Validate tool schema-definition consistency
  npm run precommit:validate-tools
  ```
- [ ] –ò–ª–∏ –¥–æ–±–∞–≤–∏—Ç—å –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π pre-commit —Ö—É–∫

### 5. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å lint-staged (–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞)

- [ ] –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è lint-staged, –¥–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é:
  ```json
  "lint-staged": {
    "src/tools/**/*.{schema,definition}.ts": [
      "npm run precommit:validate-tools"
    ]
  }
  ```

### 6. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é

- [ ] –î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É —Ñ–ª–∞–≥–∞ `--no-verify` –¥–ª—è git commit:
  ```bash
  git commit --no-verify -m "WIP: in progress"
  ```
- [ ] –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å, –∫–æ–≥–¥–∞ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `--no-verify`

### 7. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ö—É–∫–∞

- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Ö—É–∫ –Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–º –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–µ:
  - –ò–∑–º–µ–Ω–∏—Ç—å definition –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞
  - –ü–æ–ø—ã—Ç–∞—Ç—å—Å—è –∑–∞–∫–æ–º–º–∏—Ç–∏—Ç—å
  - –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –∫–æ–º–º–∏—Ç –ø—Ä–æ—Ö–æ–¥–∏—Ç
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Ö—É–∫ –Ω–∞ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–º –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–µ:
  - –°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç —Å –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ–º
  - –ü–æ–ø—ã—Ç–∞—Ç—å—Å—è –∑–∞–∫–æ–º–º–∏—Ç–∏—Ç—å
  - –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –∫–æ–º–º–∏—Ç –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è —Å –ø–æ–Ω—è—Ç–Ω—ã–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º

---

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è

### –ü–æ–¥—Ö–æ–¥ –∫ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—é –∏–∑–º–µ–Ω–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤

**–í–∞—Ä–∏–∞–Ω—Ç 1: Git staged files**
```bash
git diff --cached --name-only --diff-filter=ACM | grep -E '\.(schema|definition)\.ts$'
```
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Ç–æ–ª—å–∫–æ staged —Ñ–∞–π–ª—ã
- –ë—ã—Å—Ç—Ä–æ

**–í–∞—Ä–∏–∞–Ω—Ç 2: Git diff —Å –±–∞–∑–æ–≤–æ–π –≤–µ—Ç–∫–æ–π**
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –≤–µ—Ç–∫–µ
- –ú–µ–¥–ª–µ–Ω–Ω–µ–µ

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤–∞—Ä–∏–∞–Ω—Ç 1 (staged files)

### –ü–æ–¥—Ö–æ–¥ –∫ —Ä–µ—é–∑—É –ª–æ–≥–∏–∫–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏

**–í–∞—Ä–∏–∞–Ω—Ç 1: –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–∑ —Ç–µ—Å—Ç–æ–≤**
```typescript
import { validateSchemaDefinitionMatch } from '../tests/helpers/schema-definition-validator.js';
```
- DRY –ø—Ä–∏–Ω—Ü–∏–ø
- –ú–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å —ç–∫—Å–ø–æ—Ä—Ç –∏–∑ test helpers

**–í–∞—Ä–∏–∞–Ω—Ç 2: –î—É–±–ª–∏—Ä–æ–≤–∞—Ç—å –ª–æ–≥–∏–∫—É**
- –ú–µ–Ω–µ–µ DRY
- –ü—Ä–æ—â–µ –≤ –ø–ª–∞–Ω–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤–∞—Ä–∏–∞–Ω—Ç 1, –≤—ã–Ω–µ—Å—Ç–∏ –≤–∞–ª–∏–¥–∞—Ç–æ—Ä –≤ –æ–±—â—É—é —É—Ç–∏–ª–∏—Ç—É

---

## üìù –í—ã—Ö–æ–¥–Ω—ã–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã

1. **–§–∞–π–ª:** `scripts/validate-tool-schema-definition.ts`
   - –°–∫—Ä–∏–ø—Ç –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∏–∑–º–µ–Ω–µ–Ω–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤

2. **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** `package.json`
   - –î–æ–±–∞–≤–ª–µ–Ω npm —Å–∫—Ä–∏–ø—Ç `precommit:validate-tools`

3. **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** `.husky/pre-commit` –∏–ª–∏ `.lintstagedrc`
   - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –≤ pre-commit —Ö—É–∫

4. **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** –†–∞–∑–¥–µ–ª –≤ CLAUDE.md –∏–ª–∏ README
   - –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é —Ö—É–∫–∞
   - –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –≤—Ä–µ–º–µ–Ω–Ω–æ–º—É –æ—Ç–∫–ª—é—á–µ–Ω–∏—é (--no-verify)

---

## ‚ö†Ô∏è –ö—Ä–∏—Ç–µ—Ä–∏–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è

- [ ] –°–∫—Ä–∏–ø—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Å–æ–∑–¥–∞–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –•—É–∫ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω –≤ pre-commit
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω –Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞—Ö ‚Äî –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω –Ω–∞ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞—Ö ‚Äî –±–ª–æ–∫–∏—Ä—É–µ—Ç
- [ ] –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞
- [ ] –ó–∞–ø—É—â–µ–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è: `npm run validate` ‚Äî —É—Å–ø–µ—à–Ω–æ
- [ ] –°–æ–∑–¥–∞–Ω –∫–æ–º–º–∏—Ç –∏ –ø—É—à –≤ –≤–µ—Ç–∫—É –ø–ª–∞–Ω–∞
- [ ] –°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–æ —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º

---

## üîó –°–≤—è–∑–∞–Ω–Ω—ã–µ —ç—Ç–∞–ø—ã

- **–ó–∞–≤–∏—Å–∏—Ç –æ—Ç:** 0.1 (–∞–Ω–∞–ª–∏–∑)
- **–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ —Å:** 1.1, 1.3, 1.4
- **–ë–ª–æ–∫–∏—Ä—É–µ—Ç:** 2.1 (–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è)
