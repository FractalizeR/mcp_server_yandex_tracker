# –≠—Ç–∞–ø 1.1: Infrastructure Extraction (SEQUENTIAL)

**–í—Ä–µ–º—è:** 6-8 —á–∞—Å–æ–≤
**–¢–∏–ø:** SEQUENTIAL (–±–ª–æ–∫–∏—Ä—É–µ—Ç –≠—Ç–∞–ø 2)
**–í–µ—Ç–∫–∞:** `claude/execution-1.1-infrastructure-{session_id}`

## üéØ –¶–µ–ª—å

–ò–∑–≤–ª–µ—á—å domain-specific –∫–æ–¥ –∏–∑ infrastructure –ø–∞–∫–µ—Ç–∞ –≤ yandex-tracker.

## üìã –î–µ—Ç–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω

**–ò—Å—Ç–æ—á–Ω–∏–∫:** `packages/framework/infrastructure/src/config.ts` (371 —Å—Ç—Ä–æ–∫–∞)
**–¶–µ–ª—å:** –ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å domain-specific –∫–æ–¥ –≤ yandex-tracker

### –®–∞–≥ 1: –°–æ–∑–¥–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –≤ yandex-tracker (30 –º–∏–Ω)

**1.1 –°–æ–∑–¥–∞—Ç—å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏:**
```bash
mkdir -p packages/servers/yandex-tracker/src/config
```

**1.2 –°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª—ã:**
- `config/server-config.interface.ts` - ServerConfig interface, —Ç–∏–ø—ã
- `config/config-loader.ts` - loadConfig() function
- `config/constants.ts` - DEFAULT_* –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã
- `config/index.ts` - re-exports

**1.3 –ü—Ä–æ–≤–µ—Ä–∫–∞:**
```bash
ls -la packages/servers/yandex-tracker/src/config/
```

---

### –®–∞–≥ 2: –ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å —Ç–∏–ø—ã –∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã (40 –º–∏–Ω)

**–ß—Ç–æ –ø–µ—Ä–µ–Ω–æ—Å–∏–º –∏–∑ `infrastructure/src/config.ts` ‚Üí `yandex-tracker/src/config/server-config.interface.ts`:**

**2.1 –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –∏ —Ç–∏–ø—ã:**
- `ServerConfig` interface (–ø–æ–ª–Ω–æ—Å—Ç—å—é)
- `LogLevel` type
- `ParsedCategoryFilter` type
- `ToolDiscoveryMode` type
- `ConfigValidationError` class

**2.2 –ü—Ä–æ–≤–µ—Ä–∫–∞:**
```typescript
// –§–∞–π–ª –¥–æ–ª–∂–µ–Ω —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å:
export interface ServerConfig { /* ... */ }
export type LogLevel = 'debug' | 'info' | 'warn' | 'error';
export class ConfigValidationError extends Error { /* ... */ }
```

---

### –®–∞–≥ 3: –ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã (30 –º–∏–Ω)

**–ß—Ç–æ –ø–µ—Ä–µ–Ω–æ—Å–∏–º –∏–∑ `infrastructure/src/constants.ts` ‚Üí `yandex-tracker/src/config/constants.ts`:**

**3.1 Domain-specific –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã (–ü–ï–†–ï–ù–û–°–ò–ú):**
- `DEFAULT_API_BASE` - 'https://api.tracker.yandex.net/v2'
- `DEFAULT_LOG_LEVEL` - 'info'
- `DEFAULT_REQUEST_TIMEOUT`
- `DEFAULT_MAX_BATCH_SIZE`
- `DEFAULT_MAX_CONCURRENT_REQUESTS`
- `DEFAULT_LOGS_DIR`
- `DEFAULT_LOG_MAX_SIZE`
- `DEFAULT_LOG_MAX_FILES`
- `DEFAULT_TOOL_DISCOVERY_MODE`
- `DEFAULT_ESSENTIAL_TOOLS`
- `ENV_VAR_NAMES` - –≤—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

**3.2 Generic –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã (–û–°–¢–ê–í–õ–Ø–ï–ú –≤ infrastructure):**
- HTTP_* –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã (–µ—Å–ª–∏ –µ—Å—Ç—å)
- Cache-related –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã (–µ—Å–ª–∏ –µ—Å—Ç—å)

---

### –®–∞–≥ 4: –ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –ª–æ–≥–∏–∫—É –∑–∞–≥—Ä—É–∑–∫–∏ (1-1.5—á)

**–ß—Ç–æ –ø–µ—Ä–µ–Ω–æ—Å–∏–º –∏–∑ `infrastructure/src/config.ts` ‚Üí `yandex-tracker/src/config/config-loader.ts`:**

**4.1 –§—É–Ω–∫—Ü–∏–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ (–≤—Å–µ):**
- `validateLogLevel()`
- `validateTimeout()`
- `validateBatchSize()`
- `validateConcurrentRequests()`
- `parseToolCategoryFilter()`
- `parseBoolean()`

**4.2 –ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è:**
- `loadConfig(): ServerConfig`

**4.3 –û–±–Ω–æ–≤–∏—Ç—å imports:**
```typescript
import type { ServerConfig, LogLevel } from './server-config.interface.js';
import {
  DEFAULT_API_BASE,
  DEFAULT_LOG_LEVEL,
  // ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã
} from './constants.js';
```

---

### –®–∞–≥ 5: –°–æ–∑–¥–∞—Ç—å re-exports (10 –º–∏–Ω)

**yandex-tracker/src/config/index.ts:**
```typescript
export { ServerConfig, LogLevel, ParsedCategoryFilter, ToolDiscoveryMode, ConfigValidationError } from './server-config.interface.js';
export { loadConfig } from './config-loader.js';
export * from './constants.js';
```

---

### –®–∞–≥ 6: –û–±–Ω–æ–≤–∏—Ç—å imports –≤ yandex-tracker (1.5-2—á)

**6.1 –ù–∞–π—Ç–∏ –≤—Å–µ –∏–º–ø–æ—Ä—Ç—ã:**
```bash
grep -r "from '@mcp-framework/infrastructure'" packages/servers/yandex-tracker/src | grep -i config
```

**6.2 –ó–∞–º–µ–Ω–∏—Ç—å –∏–º–ø–æ—Ä—Ç—ã:**
```typescript
// –î–û:
import { ServerConfig, loadConfig } from '@mcp-framework/infrastructure';

// –ü–û–°–õ–ï:
import { ServerConfig, loadConfig } from '#config';
```

**6.3 –§–∞–π–ª—ã –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è (–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–æ—á–Ω–æ):**
- `src/index.ts` (main entry)
- `src/composition-root/container.ts`
- `src/cli/**/*.ts` (CLI commands)

---

### –®–∞–≥ 7: –û—á–∏—Å—Ç–∏—Ç—å infrastructure (30 –º–∏–Ω)

**7.1 –£–¥–∞–ª–∏—Ç—å –∏–∑ infrastructure:**
```bash
# –ù–ï —É–¥–∞–ª—è—Ç—å —Ñ–∞–π–ª—ã —Å—Ä–∞–∑—É! –°–Ω–∞—á–∞–ª–∞ –∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥
```

**–í `infrastructure/src/config.ts`:**
- –£–¥–∞–ª–∏—Ç—å ServerConfig interface
- –£–¥–∞–ª–∏—Ç—å loadConfig() function
- –£–¥–∞–ª–∏—Ç—å –≤—Å–µ domain-specific –∫–æ–¥

**–í `infrastructure/src/constants.ts`:**
- –£–¥–∞–ª–∏—Ç—å DEFAULT_API_BASE –∏ –≤—Å–µ Yandex-specific –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã

**7.2 –û–±–Ω–æ–≤–∏—Ç—å `infrastructure/src/index.ts`:**
```typescript
// –£–¥–∞–ª–∏—Ç—å:
export { ServerConfig, loadConfig } from './config.js';
```

**7.3 –ï—Å–ª–∏ –æ—Å—Ç–∞–ª—Å—è generic –∫–æ–¥ - –æ—Å—Ç–∞–≤–∏—Ç—å, –µ—Å–ª–∏ –Ω–µ—Ç - —É–¥–∞–ª–∏—Ç—å —Ñ–∞–π–ª –ø–æ–ª–Ω–æ—Å—Ç—å—é**

---

### –®–∞–≥ 8: –û–±–Ω–æ–≤–∏—Ç—å —Ç–µ—Å—Ç—ã (1-1.5—á)

**8.1 –ù–∞–π—Ç–∏ —Ç–µ—Å—Ç—ã config:**
```bash
find packages/servers/yandex-tracker/tests -name "*config*"
```

**8.2 –û–±–Ω–æ–≤–∏—Ç—å imports –≤ —Ç–µ—Å—Ç–∞—Ö:**
```typescript
// –î–û:
import { loadConfig } from '@mcp-framework/infrastructure';

// –ü–û–°–õ–ï:
import { loadConfig } from '#config';
```

**8.3 –ï—Å–ª–∏ –µ—Å—Ç—å —Ç–µ—Å—Ç—ã –≤ infrastructure - —É–¥–∞–ª–∏—Ç—å –∏—Ö**

---

### –®–∞–≥ 9: –í–∞–ª–∏–¥–∞—Ü–∏—è (30-40 –º–∏–Ω)

**9.1 Build:**
```bash
npm run build
```

**9.2 –ü—Ä–æ–≤–µ—Ä–∫–∞ domain isolation:**
```bash
# –ù–ï –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —É–ø–æ–º–∏–Ω–∞–Ω–∏–π yandex/tracker –≤ infrastructure:
grep -ri "yandex\|tracker\|issue\|queue" packages/framework/infrastructure/src
# –û–∂–∏–¥–∞–µ–º: –ø—É—Å—Ç–æ–π –≤—ã–≤–æ–¥
```

**9.3 Typecheck:**
```bash
npm run typecheck
```

**9.4 Tests:**
```bash
npm run test:quiet
```

**9.5 –ü–æ–ª–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è:**
```bash
npm run validate:quiet
```

## ‚úÖ Success Criteria
- [ ] Infrastructure builds –±–µ–∑ domain code
- [ ] Yandex-tracker has local config
- [ ] All tests pass
- [ ] –ö–æ–º–º–∏—Ç –∏ –ø—É—à

**–†–∞–∑–±–ª–æ–∫–∏—Ä—É–µ—Ç:** –≠—Ç–∞–ø 2.2 (ToolRegistry)
